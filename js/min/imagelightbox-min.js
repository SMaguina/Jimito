!function($,t,n,e){"use strict";var i=function(){var t=n.body||n.documentElement,t=t.style;return""==t.WebkitTransition?"-webkit-":""==t.MozTransition?"-moz-":""==t.OTransition?"-o-":""==t.transition&&""},o=!1!==i(),r=function(t,n,e){var o={},r=i();o[r+"transform"]="translateX("+n+")",o[r+"transition"]=r+"transform "+e+"s linear",t.css(o)},a="ontouchstart"in t,u=t.navigator.pointerEnabled||t.navigator.msPointerEnabled,c=function(t){if(a)return!0;if(!u||void 0===t||void 0===t.pointerType)return!1;if(void 0!==t.MSPOINTER_TYPE_MOUSE){if(t.MSPOINTER_TYPE_MOUSE!=t.pointerType)return!0}else if("mouse"!=t.pointerType)return!0;return!1};$.fn.imageLightbox=function(e){var e=$.extend({selector:'id="imagelightbox"',allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,preloadNext:!0,enableKeyboard:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,onStart:!1,onEnd:!1,onLoadStart:!1,onLoadEnd:!1},e),i=$([]),l=$(),f=$(),d=0,p=0,s=0,g=!1,h=function(t){return"a"==$(t).prop("tagName").toLowerCase()&&new RegExp(".("+e.allowedTypes+")$","i").test($(t).attr("href"))},m=function(){if(!f.length)return!0;var n=.8*$(t).width(),e=.9*$(t).height(),i=new Image;i.src=f.attr("src"),i.onload=function(){if(d=i.width,p=i.height,d>n||p>e){var o=d/p>n/e?d/n:p/e;d/=o,p/=o}f.css({width:d+"px",height:p+"px",top:($(t).height()-p)/2+"px",left:($(t).width()-d)/2+"px"})}},v=function(t){if(g)return!1;if(t=void 0!==t&&("left"==t?1:-1),f.length){if(!1!==t&&(i.length<2||!0===e.quitOnEnd&&(-1===t&&0==i.index(l)||1===t&&i.index(l)==i.length-1)))return E(),!1;var n={opacity:0};o?r(f,100*t-s+"px",e.animationSpeed/1e3):n.left=parseInt(f.css("left"))+100*t+"px",f.animate(n,e.animationSpeed,function(){x()}),s=0}g=!0,!1!==e.onLoadStart&&e.onLoadStart(),setTimeout(function(){f=$("<img "+e.selector+" />").attr("src",l.attr("href")).load(function(){f.appendTo("body"),m();var n={opacity:1};if(f.css("opacity",0),o)r(f,-100*t+"px",0),setTimeout(function(){r(f,"0px",e.animationSpeed/1e3)},50);else{var a=parseInt(f.css("left"));n.left=a+"px",f.css("left",a-100*t+"px")}if(f.animate(n,e.animationSpeed,function(){g=!1,!1!==e.onLoadEnd&&e.onLoadEnd()}),e.preloadNext){var u=i.eq(i.index(l)+1);u.length||(u=i.eq(0)),$("<img />").attr("src",u.attr("href")).load()}}).error(function(){!1!==e.onLoadEnd&&e.onLoadEnd()});var n=0,a=0,p=0;f.on(u?"pointerup MSPointerUp":"click",function(t){if(t.preventDefault(),e.quitOnImgClick)return E(),!1;if(c(t.originalEvent))return!0;var n=(t.pageX||t.originalEvent.pageX)-t.target.offsetLeft;l=i.eq(i.index(l)-(d/2>n?1:-1)),l.length||(l=i.eq(d/2>n?i.length:0)),v(d/2>n?"left":"right")}).on("touchstart pointerdown MSPointerDown",function(t){if(!c(t.originalEvent)||e.quitOnImgClick)return!0;o&&(p=parseInt(f.css("left"))),n=t.originalEvent.pageX||t.originalEvent.touches[0].pageX}).on("touchmove pointermove MSPointerMove",function(t){if(!c(t.originalEvent)||e.quitOnImgClick)return!0;t.preventDefault(),a=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,s=n-a,o?r(f,-s+"px",0):f.css("left",p-s+"px")}).on("touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",function(t){if(!c(t.originalEvent)||e.quitOnImgClick)return!0;Math.abs(s)>50?(l=i.eq(i.index(l)-(s<0?1:-1)),l.length||(l=i.eq(s<0?i.length:0)),v(s>0?"right":"left")):o?r(f,"0px",e.animationSpeed/1e3):f.animate({left:p+"px"},e.animationSpeed/2)})},e.animationSpeed+100)},x=function(){if(!f.length)return!1;f.remove(),f=$()},E=function(){if(!f.length)return!1;f.animate({opacity:0},e.animationSpeed,function(){x(),g=!1,!1!==e.onEnd&&e.onEnd()})};return $(t).on("resize",m),e.quitOnDocClick&&$(n).on(a?"touchend":"click",function(t){f.length&&!$(t.target).is(f)&&E()}),e.enableKeyboard&&$(n).on("keyup",function(t){if(!f.length)return!0;t.preventDefault(),27==t.keyCode&&E(),37!=t.keyCode&&39!=t.keyCode||(l=i.eq(i.index(l)-(37==t.keyCode?1:-1)),l.length||(l=i.eq(37==t.keyCode?i.length:0)),v(37==t.keyCode?"left":"right"))}),$(n).on("click",this.selector,function(t){return!h(this)||(t.preventDefault(),!g&&(g=!1,!1!==e.onStart&&e.onStart(),l=$(this),void v()))}),this.each(function(){if(!h(this))return!0;i=i.add($(this))}),this.switchImageLightbox=function(t){var n=i.eq(t);if(n.length){var e=i.index(l);l=n,v(t<e?"left":"right")}return this},this.quitImageLightbox=function(){return E(),this},this}}(jQuery,window,document);